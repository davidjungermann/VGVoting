(this["webpackJsonpvg-voting"]=this["webpackJsonpvg-voting"]||[]).push([[0],{21:function(e,t,n){e.exports=n(40)},30:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(13),c=n.n(r),s=(n(26),n(27),n(14)),u=n(15),i=n(20),o=n(18),m=n(17),b=n(19),E=n(1);n(30);function f(e){var t=Object(a.useState)([]),n=Object(E.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(!1),u=Object(E.a)(s,2),i=u[0],o=u[1],m=Object(a.useState)("V\xe4lj en fil med r\xf6stkoder"),f=Object(E.a)(m,2),d=f[0],g=f[1],h=Object(a.useState)("V\xe4lj en fil med r\xf6ster"),p=Object(E.a)(h,2),v=p[0],j=p[1];Object(a.useEffect)((function(){0===r.length?o(!1):2===r.length&&o(!0)}),[r]);var N=function(e){e.preventDefault();var t=e.target.id,n=e.target.files[0];c([].concat(Object(b.a)(r),[{file_id:t,uploaded_file:n}])),"0"===t?g(null===n||void 0===n?void 0:n.name):j(null===n||void 0===n?void 0:n.name)};return l.a.createElement("div",{className:"container"},l.a.createElement("form",{className:"upload-container",onSubmit:function(t){t.preventDefault(),r.forEach((function(t){"0"===(null===t||void 0===t?void 0:t.file_id)?e.setVoteCodeFile(null===t||void 0===t?void 0:t.uploaded_file):e.setVoteFile(null===t||void 0===t?void 0:t.uploaded_file),e.setSubmitted(!0),c([]),g("V\xe4lj en fil med r\xf6stkoder"),j("V\xe4lj en fil med r\xf6ster")}))}},l.a.createElement("div",{className:"upload-btn"},l.a.createElement("h3",{className:"file-upload-header"},"R\xf6stkoder"),l.a.createElement("input",{id:0,name:"file",type:"file",accept:".xlsx",className:"file-input",onChange:N}),l.a.createElement("label",{htmlFor:0},d)),l.a.createElement("div",{className:"upload-btn"},l.a.createElement("h3",{className:"file-upload-header"},"R\xf6ster"),l.a.createElement("input",{id:1,type:"file",accept:".xlsx",className:"file-input",onChange:N}),l.a.createElement("label",{htmlFor:1},v)),i?l.a.createElement("div",{className:"submit-btn-root"},l.a.createElement("button",{className:"btn btn-success btn-lg",type:"submit"},"Ladda upp")):l.a.createElement("div",{className:"submit-btn-root"},l.a.createElement("button",{className:"btn btn-success btn-lg",type:"submit",disabled:!0},"Ladda upp"))))}var d=n(3),g=n.n(d),h=n(31);function p(e){var t=Object(a.useState)([]),n=Object(E.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)([]),u=Object(E.a)(s,2),i=u[0],o=u[1],m=Object(a.useState)(!1),b=Object(E.a)(m,2),f=b[0],d=b[1],p=Object(a.useState)(!0),v=Object(E.a)(p,2),j=v[0],N=v[1],O=Object(a.useState)(null),k=Object(E.a)(O,2),y=k[0],x=k[1],S=Object(a.useState)(0),C=Object(E.a)(S,2),w=C[0],R=C[1],V=Object(a.useState)(null),F=Object(E.a)(V,2),W=F[0],B=F[1],G=Object(a.useState)(null),_=Object(E.a)(G,2),A=_[0],D=_[1],T=Object(a.useState)(null),J=Object(E.a)(T,2),L=J[0],I=J[1],$=Object(a.useState)(null),q=Object(E.a)($,2),z=q[0],H=q[1];Object(a.useEffect)((function(){M(),K()}),[]);var K=function(){var t=new h.Workbook;e.voteFile.arrayBuffer().then((function(e){t.xlsx.load(e)})),I(t)},M=function(){var t=new h.Workbook;e.voteCodeFile.arrayBuffer().then((function(e){t.xlsx.load(e)})),D(t)},P=function(){var e=[];return L.getWorksheet().getColumn("B").eachCell((function(t){return e.push(t.text)})),e.slice(1)},Q=function(){var e=[];return A.getWorksheet().getColumn("A").eachCell((function(t){return e.push(t.text)})),e},U=function(){for(var e=L.getWorksheet(),t=function(){var e={};return L.getWorksheet().getRow(1).eachCell((function(t){"Tidst\xe4mpel"!==t.text&&"Valkod"!==t.text&&(e[t.text]=[])})),e}(),n=3;n<=e.actualColumnCount;n++)e.getColumn(n).eachCell((function(e){for(var n in t)if(e.text.startsWith(n)){var a=t[n];a.push(e.text),t[n]=a}}));for(var a in t)t[a].shift();return t},X=function(t){e.setSubmitted(!1),t.preventDefault()},Y=function(){var e=function(){var e=U(),t={};for(var n in e)e[n].forEach((function(e){(e=e.split(",")).forEach((function(e){(e=e.trim()).endsWith("*")&&(e=e.replace(/\*/g,"")),t[e]=t[e]+1||1}))}));return t}(),t=[];(function(){var e=[],t=P(),n=Q(),a=[],l=[];return t.forEach((function(t){n.includes(t)?(e.push(t),a.push("Giltig r\xf6st: "+t),n=n.filter((function(e){return e!==t}))):e.includes(t)?(l.push("Ogiltig r\xf6st, har r\xf6stat mer \xe4n 1 g\xe5ng: "+t),x(!1)):(l.push("Ogiltig r\xf6st, ej registrerad: "+t),x(!1))})),0===l.length&&x(!0),[a,l]})().forEach((function(e){return e.forEach((function(e){return t.push(e)}))}));var n=Object.entries(e),a=[];n.forEach((function(e){var t=Object(E.a)(e,2),n=t[0],l=t[1];if(1===l)var r=" r\xf6st";else r=" r\xf6ster";a.push(n+": "+l+r)})),c(t),o(a),d(!0),N(!1),R(Q().length),H(function(){var e=[],t=P(),n=Q();n.length>t.length?(x(!1),B(!1),n.filter((function(e){return!t.includes(e)})).forEach((function(t){e.push("Registrerad, men har ej r\xf6stat: "+t)}))):n.length<t.length?B(!1):B(!0);return e}())};return l.a.createElement("div",{className:"container w-50"},f?y&&W?l.a.createElement("div",{className:"container w-75"},l.a.createElement("h1",null,l.a.createElement("b",null,"Resultat")),l.a.createElement("ul",{className:"list-group"},i.map((function(e){return l.a.createElement("li",{key:g()(),className:"list-group-item"}," ",l.a.createElement("h3",null," ",e))}))),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("h1",null,l.a.createElement("b",null,"R\xf6stvalidering")),l.a.createElement("br",null),l.a.createElement("h3",null,l.a.createElement("b",null,"Antal r\xf6stande: ",r.length)),l.a.createElement("h3",null,l.a.createElement("b",null,"R\xf6stl\xe4ngd: ",w)),l.a.createElement("br",null),l.a.createElement("ul",{className:"list-group"},r.map((function(e){return l.a.createElement("li",{key:g()(),className:"list-group-item"}," ",l.a.createElement("h3",null," ",e))}))),l.a.createElement("div",{className:"col text-center"},l.a.createElement("button",{type:"button",className:"btn btn-success m-4 btn-lg",onClick:X},"Genomf\xf6r en ny r\xf6stning"))):y&&!W?l.a.createElement("div",{className:"container w-75"},l.a.createElement("h5",null,l.a.createElement("b",null,"R\xf6stningen \xe4r inte giltig. R\xf6stl\xe4ngd och antalet r\xf6ster st\xe4mmer \xf6verensst\xe4mmer inte.")),l.a.createElement("br",null),l.a.createElement("ul",{className:"list-group"},z.map((function(e){return l.a.createElement("li",{key:g()(),className:"list-group-item"}," ",l.a.createElement("h3",null," ",e))}))),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("h5",null,"Antal r\xf6stande: ",r.length),l.a.createElement("h5",null,"R\xf6stl\xe4ngd: ",w)),l.a.createElement("div",{className:"col text-center"},l.a.createElement("button",{type:"button",className:"btn btn-success m-4 btn-lg",onClick:X},"Genomf\xf6r en ny r\xf6stning"))):!y&&W?l.a.createElement("div",{className:"container w-75"},l.a.createElement("h5",null,l.a.createElement("b",null,"R\xf6stningen \xe4r inte giltig. Ta bort ogiltiga r\xf6ster ur Excel-arket och ladda upp igen:"," ")),l.a.createElement("br",null),l.a.createElement("ul",{className:"list-group"},r.map((function(e){return l.a.createElement("li",{key:g()(),className:"list-group-item"}," ",l.a.createElement("h3",null," ",e))}))),l.a.createElement("div",{className:"col text-center"},l.a.createElement("button",{type:"button",className:"btn btn-success m-4 btn-lg",onClick:X},"Genomf\xf6r en ny r\xf6stning"))):y||W?void 0:l.a.createElement("div",{className:"container w-75"},l.a.createElement("h5",null,l.a.createElement("b",null,"R\xf6stningen \xe4r inte giltig. Ta bort ogiltiga r\xf6ster ur Excel-arket och ladda upp igen:"," ")),l.a.createElement("br",null),l.a.createElement("ul",{className:"list-group"},r.map((function(e){return l.a.createElement("li",{key:g()(),className:"list-group-item"}," ",l.a.createElement("h3",null," ",e))}))),l.a.createElement("br",null),l.a.createElement("ul",{className:"list-group"},z.map((function(e){return l.a.createElement("li",{key:g()(),className:"list-group-item"}," ",l.a.createElement("h3",null," ",e))}))),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"R\xf6stningen \xe4r inte giltig. R\xf6stl\xe4ngd och antalet r\xf6ster st\xe4mmer \xf6verensst\xe4mmer inte.")),l.a.createElement("br",null),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("h5",null,"Antal r\xf6stande: ",r.length),l.a.createElement("h5",null,"R\xf6stl\xe4ngd: ",w)),l.a.createElement("div",{className:"col text-center"},l.a.createElement("button",{type:"button",className:"btn btn-success m-4 btn-lg",onClick:X},"Genomf\xf6r en ny r\xf6stning"))):null,l.a.createElement("div",{className:"row"}),j?l.a.createElement("div",{className:"col text-center"},l.a.createElement("button",{type:"button",className:"btn btn-success m-4 btn-lg",onClick:Y},"Visa valresultat")):null)}n(34);function v(){var e=Object(a.useState)(!1),t=Object(E.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),s=Object(E.a)(c,2),u=s[0],i=s[1],o=Object(a.useState)(null),m=Object(E.a)(o,2),b=m[0],d=m[1];return l.a.createElement("div",{className:"container-root"},l.a.createElement("div",{className:"jumbotron text-center"},l.a.createElement("h1",{className:"display-4"},"R\xf6str\xe4knare "),l.a.createElement("p",{className:"lead"},"V\xe4stg\xf6ta Nation")),n?l.a.createElement(p,{setSubmitted:r,voteCodeFile:u,voteFile:b}):l.a.createElement(f,{setSubmitted:r,setVoteCodeFile:i,setVoteFile:d}))}n(35);var j=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"composeVoteView",value:function(){return function(e){return l.a.createElement(p,e)}}},{key:"composeFileView",value:function(){return function(e){return l.a.createElement(f,e)}}},{key:"render",value:function(){return l.a.createElement(m.a,{basename:"/voting-vg"},l.a.createElement(v,null))}}]),n}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[21,1,2]]]);
//# sourceMappingURL=main.451ced09.chunk.js.map